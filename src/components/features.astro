---
import ContentSection from "~/components/content-section.astro";
---

<ContentSection title="Mines Bot" id="features">
  <Fragment slot="lead">
    O <span class="text-primary">MELHOR</span> e mais assertivo Bot
    <br>
      <br>
      AtÃ© 3 tentativas ğŸ’£ğŸ’£ğŸ’£
    <br>
  </Fragment>
  <div class="mines-wrapper">
    { Array(25).fill('hello').map((_, idx) => {
      return (<div id={idx + 1} class="interrogation"></div>)
    }) }
  </div>
    <div class="flex gap-10">
        <button id="generate-button" class="generate-button">Gerar</button>
        <a href="https://betbr.net/c-pYJv1IDj?lang=pt" target="_blank">
            <button id="subscribe-button" class="generate-button">Cadastre-se</button>
        </a>
    </div>
    <Fragment>
        <span class="text-red-400">O hack sÃ³ funciona para o site recomendado*</span>
    </Fragment>
</ContentSection>

<script>
  window.onload = () => {
    if (! isAvailable()) {
      generateButton.classList.add('disabled');
    }
  }

  function generate(count, min, max) {
    const randomNumbers = [];

    for (let i = 0; i < count; i++) {
      const randomNumber = Math.floor(Math.random() * (max - min + 1)) + min;
      randomNumbers.push(randomNumber);
    }

    return randomNumbers;
  }

  function setAvailable(available = true) {
    localStorage.setItem('status', available ? 'available' : 'disabled');
  }

  function isAvailable(): boolean
  {
    return localStorage.getItem('status') !== 'disabled';
  }

  const generateButton = document.getElementById('generate-button');

  function generateDiamonds() {
    if (! isAvailable()) {
      return;
    }

    const els = document.querySelectorAll('.diamond');

    els.forEach((el) => el.classList.remove('diamond'))

    const randomNumber = generate(3, 1, 25);

    randomNumber.forEach((mine) => {
      const el = document.getElementById(mine);

      el.classList.add('diamond');
    })

    setAvailable(false)
    generateButton.classList.add('disabled');

    setTimeout(() => {
      setAvailable(true)
      generateButton.classList.remove('disabled');
    }, 1000 * 7)
  }

  generateButton.addEventListener('click', () => {
    generateDiamonds();
  });
</script>

